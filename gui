local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "LunaButton"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = game.CoreGui

local MainButton = Instance.new("ImageButton")
MainButton.Name = "FloatingButton"
MainButton.Size = UDim2.new(0, 70, 0, 70)
MainButton.Position = UDim2.new(0, 20, 0.5, -35)
MainButton.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
MainButton.BorderSizePixel = 0
MainButton.Image = "rbxassetid://83759238826509"
MainButton.ImageTransparency = 0.1
MainButton.ScaleType = Enum.ScaleType.Fit
MainButton.Parent = ScreenGui

local Corner = Instance.new("UICorner")
Corner.CornerRadius = UDim.new(0, 16)
Corner.Parent = MainButton

local Gradient = Instance.new("UIGradient")
Gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(45, 45, 60)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 30))
}
Gradient.Rotation = 45
Gradient.Parent = MainButton

local Glow = Instance.new("ImageLabel")
Glow.Name = "Glow"
Glow.Size = UDim2.new(1, 20, 1, 20)
Glow.Position = UDim2.new(0.5, 0, 0.5, 0)
Glow.AnchorPoint = Vector2.new(0.5, 0.5)
Glow.BackgroundTransparency = 1
Glow.Image = "rbxassetid://16300778179"
Glow.ImageColor3 = Color3.fromRGB(138, 43, 226)
Glow.ImageTransparency = 0.5
Glow.ZIndex = 0
Glow.Parent = MainButton

local Stroke = Instance.new("UIStroke")
Stroke.Color = Color3.fromRGB(138, 43, 226)
Stroke.Thickness = 2.5
Stroke.Transparency = 0.3
Stroke.Parent = MainButton

local Shadow = Instance.new("ImageLabel")
Shadow.Name = "Shadow"
Shadow.Size = UDim2.new(1, 30, 1, 30)
Shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
Shadow.AnchorPoint = Vector2.new(0.5, 0.5)
Shadow.BackgroundTransparency = 1
Shadow.Image = "rbxassetid://16300778179"
Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
Shadow.ImageTransparency = 0.7
Shadow.ZIndex = -1
Shadow.Parent = MainButton

local isDragging = false
local dragInput
local dragStart
local startPos
local clickStart

local function Tween(object, props, time)
    TweenService:Create(object, TweenInfo.new(time or 0.3, Enum.EasingStyle.Quint), props):Play()
end

local function updatePos(input)
    local delta = input.Position - dragStart
    MainButton.Position = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
end

MainButton.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        isDragging = true
        dragStart = input.Position
        clickStart = input.Position
        startPos = MainButton.Position
        
        Tween(MainButton, {Size = UDim2.new(0, 65, 0, 65)}, 0.2)
        Tween(Glow, {ImageTransparency = 0.2}, 0.2)
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                isDragging = false
                Tween(MainButton, {Size = UDim2.new(0, 70, 0, 70)}, 0.2)
                Tween(Glow, {ImageTransparency = 0.5}, 0.2)
            end
        end)
    end
end)

MainButton.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and isDragging then
        updatePos(input)
    end
end)

MainButton.MouseEnter:Connect(function()
    if not isDragging then
        Tween(MainButton, {Size = UDim2.new(0, 75, 0, 75)}, 0.2)
        Tween(Stroke, {Thickness = 3}, 0.2)
        Tween(Glow, {ImageTransparency = 0.3}, 0.2)
    end
end)

MainButton.MouseLeave:Connect(function()
    if not isDragging then
        Tween(MainButton, {Size = UDim2.new(0, 70, 0, 70)}, 0.2)
        Tween(Stroke, {Thickness = 2.5}, 0.2)
        Tween(Glow, {ImageTransparency = 0.5}, 0.2)
    end
end)

MainButton.MouseButton1Click:Connect(function()
    local dragDistance = (UserInputService:GetMouseLocation() - clickStart).Magnitude
    
    if dragDistance < 5 then
        Tween(MainButton, {
            Size = UDim2.new(0, 0, 0, 0),
            BackgroundTransparency = 1,
            ImageTransparency = 1
        }, 0.4)
        Tween(Glow, {ImageTransparency = 1}, 0.4)
        Tween(Stroke, {Transparency = 1}, 0.4)
        
        wait(0.4)
        ScreenGui:Destroy()
        
        loadstring(game:HttpGet("https://raw.githubusercontent.com/mercymercypeace/Strat/refs/heads/main/custom%20gui"))()
    end
end)

spawn(function()
    while MainButton and MainButton.Parent do
        Tween(Glow, {Rotation = 360}, 3)
        wait(3)
        Glow.Rotation = 0
    end
end)
