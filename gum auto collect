local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local workspace = game:GetService("Workspace")

local range = 20
local interval = 10
local enabled = false

local function getRootPart()
    local character = player.Character
    if not character then
        character = player.CharacterAdded:Wait()
    end
    return character:WaitForChild("HumanoidRootPart")
end

local function findNearestGumdrop(rootPart)
    local nearest = nil
    local shortestDist = math.huge
    
    local pickups = workspace:FindFirstChild("Pickups")
    
    if pickups then
        for i, v in pairs(pickups:GetChildren()) do
            if v:IsA("BasePart") then
                local dist = (v.Position - rootPart.Position).magnitude
                if dist <= range and dist < shortestDist then
                    shortestDist = dist
                    nearest = v
                end
            end
        end
    end
    
    return nearest, shortestDist
end

spawn(function()
    local root = getRootPart()
    
    while true do
        if enabled then
            if not root.Parent or not root.Parent.Parent then
                root = getRootPart()
            end
            
            local gumdrop = findNearestGumdrop(root)
            
            if gumdrop then
                local pos = gumdrop.Position + Vector3.new(0, root.Size.Y / 2 + 0.1, 0)
                root.CFrame = CFrame.new(pos)
            end
        end
        
        wait(interval)
    end
end)

local Window = Fluent:CreateWindow({
    Title = "Gumdrop Collector",
    SubTitle = "Auto Farm",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "home" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" })
}

local Options = Fluent.Options

do
    Tabs.Main:AddParagraph({
        Title = "Gumdrop Auto Collector",
        Content = "Automatically teleports to nearby gumdrops\nConfigure settings below"
    })

    local Toggle = Tabs.Main:AddToggle("AutoCollect", {
        Title = "Enable Auto Collect", 
        Default = false 
    })

    Toggle:OnChanged(function()
        enabled = Options.AutoCollect.Value
        Fluent:Notify({
            Title = "Auto Collect",
            Content = enabled and "Enabled" or "Disabled",
            Duration = 3
        })
    end)

    local RangeSlider = Tabs.Main:AddSlider("Range", {
        Title = "Detection Range",
        Description = "Distance to detect gumdrops",
        Default = 20,
        Min = 10,
        Max = 100,
        Rounding = 0,
        Callback = function(Value)
            range = Value
        end
    })

    local IntervalSlider = Tabs.Main:AddSlider("Interval", {
        Title = "Check Interval",
        Description = "Time between checks (seconds)",
        Default = 10,
        Min = 1,
        Max = 20,
        Rounding = 1,
        Callback = function(Value)
            interval = Value
        end
    })
end

SaveManager:SetLibrary(Fluent)
InterfaceManager:SetLibrary(Fluent)

SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})

InterfaceManager:SetFolder("GumdropCollector")
SaveManager:SetFolder("GumdropCollector/configs")

InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)

Window:SelectTab(1)

Fluent:Notify({
    Title = "Gumdrop Collector",
    Content = "Script loaded successfully!",
    Duration = 5
})

SaveManager:LoadAutoloadConfig()
