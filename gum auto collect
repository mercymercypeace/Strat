local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local workspace = game:GetService("Workspace")

local range = 20
local interval = 10
local enabled = false

local function getRootPart()
    local character = player.Character
    if not character then
        character = player.CharacterAdded:Wait()
    end
    return character:WaitForChild("HumanoidRootPart")
end

local function findNearestGumdrop(rootPart)
    local nearest = nil
    local shortestDist = math.huge
    
    local pickups = workspace:FindFirstChild("Pickups")
    
    if pickups then
        for i, v in pairs(pickups:GetChildren()) do
            if v:IsA("BasePart") then
                local dist = (v.Position - rootPart.Position).magnitude
                if dist <= range and dist < shortestDist then
                    shortestDist = dist
                    nearest = v
                end
            end
        end
    end
    
    return nearest, shortestDist
end

spawn(function()
    local root = getRootPart()
    
    while true do
        if enabled then
            if not root.Parent or not root.Parent.Parent then
                root = getRootPart()
            end
            
            local gumdrop = findNearestGumdrop(root)
            
            if gumdrop then
                local pos = gumdrop.Position + Vector3.new(0, root.Size.Y / 2 + 0.1, 0)
                root.CFrame = CFrame.new(pos)
            end
        end
        
        wait(interval)
    end
end)

local Window = Library.CreateLib("Gumdrop Collector", "DarkTheme")

local MainTab = Window:NewTab("Main")
local MainSection = MainTab:NewSection("Auto Collector")

MainSection:NewToggle("Enable Auto Collect", "Automatically collect gumdrops", function(state)
    enabled = state
end)

MainSection:NewSlider("Detection Range", "Distance to detect gumdrops (10-100)", 100, 20, function(value)
    range = value
end)

MainSection:NewSlider("Check Interval", "Time between checks in seconds (1-20)", 20, 10, function(value)
    interval = value
end)

local SettingsTab = Window:NewTab("Settings")
local SettingsSection = SettingsTab:NewSection("UI Settings")

SettingsSection:NewKeybind("Toggle UI", "Toggle the UI visibility", Enum.KeyCode.RightControl, function()
    Library:ToggleUI()
end)

SettingsSection:NewButton("Destroy GUI", "Close the interface", function()
    game.CoreGui:FindFirstChild("MobileToggle"):Destroy()
    game.CoreGui:FindFirstChild("Main"):Destroy()
end)

-- Mobile Support: Draggable Toggle Button
local ScreenGui = Instance.new("ScreenGui")
local ToggleButton = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")
local UIStroke = Instance.new("UIStroke")

ScreenGui.Name = "MobileToggle"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false

ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = ScreenGui
ToggleButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
ToggleButton.BorderSizePixel = 0
ToggleButton.Position = UDim2.new(0.85, 0, 0.1, 0)
ToggleButton.Size = UDim2.new(0, 65, 0, 65)
ToggleButton.Font = Enum.Font.GothamBold
ToggleButton.Text = "ðŸ“‹"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.TextSize = 32
ToggleButton.Active = true
ToggleButton.Draggable = true
ToggleButton.ZIndex = 10

UICorner.CornerRadius = UDim.new(0, 15)
UICorner.Parent = ToggleButton

UIStroke.Color = Color3.fromRGB(100, 100, 100)
UIStroke.Thickness = 2
UIStroke.Parent = ToggleButton

ToggleButton.MouseButton1Click:Connect(function()
    Library:ToggleUI()
    
    local Tween = game:GetService("TweenService"):Create(ToggleButton, TweenInfo.new(0.2), {
        BackgroundColor3 = ToggleButton.BackgroundColor3 == Color3.fromRGB(45, 45, 45) and Color3.fromRGB(70, 70, 70) or Color3.fromRGB(45, 45, 45)
    })
    Tween:Play()
end)

wait(1)
game.StarterGui:SetCore("SendNotification", {
    Title = "Gumdrop Collector";
    Text = "Script loaded! Use mobile button to toggle UI";
    Duration = 5;
})
